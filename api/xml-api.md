<!-- TITLE: XML API -->
<!-- SUBTITLE: Данное API позволяет реализовать страницу управления услугами подписки в Личном кабинете провайдера/реселлера, а также добавить услуги Velvica в список уже имеющихся у провайдера услуг. -->

> Обращаем внимание, что как с технической, так и с маркетинговой точки зрения схема интеграции через API является более сложной и ресурсоемкой, чем интеграция через IFRAME. Если есть возможность, лучше воспользоваться схемой с IFRAME. 

# Получение информации об услугах
**Пример запроса**

```text
https://$AG_NAME.ag.$INSTANCE_DOMAIN/2.01/xml?
  ag_uuid=$agUuid&
  ag_timestamp=$agTimestamp&
  ag_sign=$agSign&
  ag_verbose=$agVerbose&
  ag_service_key=$agServiceKey
```

**где: **
* **AGNAME** в имени домена: уникальное имя оператора на платформе Velvica.
* **INSTANCEDOMAIN**: доменное имя сервера Velvica.
* **aguuid**: идентификатор текущего залогиненного абонента в системе. Если этот параметр равен пустой строке или 0, то возвращаются просто все имеющиеся услуги. Если запрос производится из интерфейса оператора техподдержки, то aguuid должен иметь формат: IDabonenta@IDсотрудникаподдержки, например: 121000283738@87654. При этом ID сотрудника поддержки может выбираться оператором по его усмотрению (чаще всего берут первичный ключ из БД сотрудников), но он обязательно должен состоять из одних цифр.
* **agtimestamp**: timestamp формирования текущей страницы (int32).
* **agsign**: значение `md5($AGSECRET + "ЧастьЗапросаМеждуAgUuidВключительноиAgSignИсключая")`. Внимание: при вычислении md5 нужно подставить именно строковое значение части URL запроса, не меняя порядок параметров. В примере выше оно равно `$AGSECRET+"aguuid=$agUuid&agtimestamp=$agTimestamp"`, а для запроса `"/?a=a&b=b&aguuid=123&c=c&d=d&agsign=xxxxx"` значение было бы` $AGSECRET+"aguuid=123&c=c&d=d"`.
* **agverbose**: если 0, то поля verbose не возвращаются (для экономии производительности). Если 1, то возвращается полное содержимое.
* **agservicekey**: если задан, возвращается информация только об услуге с данным ключом (если не задан, то обо всех услугах).

Все параметры должны передаваться URL-кодированными, как принято в протоколе HTTP (т.е. специальные символы представлены в виде %XX).
 
